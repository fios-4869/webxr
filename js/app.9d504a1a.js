(function(){"use strict";var e={4738:function(e,t,n){var o=n(9242),i=n(3396);function r(e,t){const n=(0,i.up)("router-view");return(0,i.wg)(),(0,i.j4)(n)}var a=n(89);const s={},d=(0,a.Z)(s,[["render",r]]);var c=d,l=n(2483),u=(n(7658),n(4870)),p=n(1114),f=n(9469),w=n(1341),h=n(7061),v=n(4543),g=(0,i.aZ)({__name:"HomeView",setup(e){const t=(0,u.iH)(null);let n,o,r,a,s;const d=new f.E;let c,l,g,m,x,b,y;const O=new p.yGw;let j=[];function E(){o=new p.xsS,o.background=new p.Ilk(5263440);const e=(new p.cBK).setPath("static/skybox/cloudy/").load(["right.jpg","left.jpg","top.jpg","bottom.jpg","front.jpg","back.jpg"]);e.encoding=p.knz,o.background=e;const i=(new p.dpR).load("static/terrain/grass.jpg");i.wrapS=i.wrapT=p.rpg,i.repeat.set(20,20),i.anisotropy=16,i.encoding=p.knz;const u=new p.Kj0(new p.zf8(12,200),new p.xoR({map:i}));u.rotation.x=-Math.PI/2,u.receiveShadow=!0,o.add(u),n=new p.cPb(50,t.value.offsetWidth/t.value.offsetHeight,.1,1e3),n.position.set(0,10,20),o.add(new p.vmT(6316128,4210752));const f=new p.Ox3(16777215,2);f.position.set(1,1,1).normalize(),o.add(f);const O=new p.Ox3(16777215,1);O.position.set(-6,10,-10).normalize(),o.add(O);const E=new p.Ox3(16777215,.3);E.position.set(0,-5,0).normalize(),o.add(E);let S=new p.Ox3(16777215,6);function C(){this.userData.isSelecting=!0}function z(){if(this.userData.isSelecting=!1,y){const e={x:-y.x,y:-y.y,z:-y.z,w:1},t=new p._fP,n=new XRRigidTransform(e,t),o=l.getOffsetReferenceSpace(n);r.xr.setReferenceSpace(o)}}S.position.set(12,23,14),S.castShadow=!0,S.shadow.mapSize.set(1024,1024),S.shadow.bias=-5e-5,S.shadow.normalBias=.05,S.shadow.camera.top=20,S.shadow.camera.bottom=-20,S.shadow.camera.left=-20,S.shadow.camera.right=20,o.add(S),c=new p.Kj0(new p.xo$(.25,32,16),new p.vBJ({color:8421504})),o.add(c),a=new p.iMs,r=new p.CP7({antialias:!0}),r.setPixelRatio(window.devicePixelRatio),r.setSize(window.innerWidth,window.innerHeight),r.outputEncoding=p.knz,r.toneMapping=p.CdI,r.toneMappingExposure=3,r.physicallyCorrectLights=!0,r.shadowMap.enabled=!0,r.shadowMap.type=p.ntZ,r.xr.addEventListener("sessionstart",(()=>l=r.xr.getReferenceSpace())),r.xr.enabled=!0,t.value.appendChild(r.domElement),t.value.appendChild(w.N.createButton(r)),s=new v.z(n,r.domElement),s.update(),window.addEventListener("resize",k),d.load("static/models/building.glb",(function(e){console.log(e),e.scene.traverse((e=>{e.isMesh&&(e.castShadow=!0,e.receiveShadow=!0,e.name.indexOf("网格159")>-1&&(e.castShadow=!1))})),e.scene.children.forEach((e=>{const t=["louti_1f","Obj3d66-455969-2-272","Obj3d66-455969-2-273"];(e.name.indexOf("diban")>-1||t.indexOf(e.name)>-1)&&j.push(e)})),e.scene.scale.set(1,1,1),o.add(e.scene)})),g=r.xr.getController(0),g.addEventListener("selectstart",C),g.addEventListener("selectend",z),g.addEventListener("connected",(function(e){this.add(M(e.data))})),g.addEventListener("disconnected",(function(){this.remove(this.children[0])})),o.add(g),m=r.xr.getController(1),m.addEventListener("selectstart",C),m.addEventListener("selectend",z),m.addEventListener("connected",(function(e){this.add(M(e.data))})),m.addEventListener("disconnected",(function(){this.remove(this.children[0])})),o.add(m);const L=new h.i;x=r.xr.getControllerGrip(0),x.add(L.createControllerModel(x)),o.add(x),b=r.xr.getControllerGrip(1),b.add(L.createControllerModel(b)),o.add(b)}function M(e){let t,n;switch(e.targetRayMode){case"tracked-pointer":return t=new p.u9r,t.setAttribute("position",new p.a$l([0,0,0,0,0,-1],3)),t.setAttribute("color",new p.a$l([.5,.5,.5,0,0,0],3)),n=new p.nls({vertexColors:!0,blending:p.WMw}),new p.x12(t,n);case"gaze":return t=new p.o8S(.02,.04,32).translate(0,0,-1),n=new p.vBJ({opacity:.5,transparent:!0}),new p.Kj0(t,n)}}function S(){r.setAnimationLoop(C)}function C(){if(s.update(),y=void 0,!0===g.userData.isSelecting){O.identity().extractRotation(g.matrixWorld),a.ray.origin.setFromMatrixPosition(g.matrixWorld),a.ray.direction.set(0,0,-1).applyMatrix4(O);const e=a.intersectObjects([...j]);e.length>0&&(y=e[0].point)}else if(!0===m.userData.isSelecting){O.identity().extractRotation(m.matrixWorld),a.ray.origin.setFromMatrixPosition(m.matrixWorld),a.ray.direction.set(0,0,-1).applyMatrix4(O);const e=a.intersectObjects([...j]);e.length>0&&(y=e[0].point)}y&&c.position.copy(y),c.visible=void 0!==y,r.render(o,n)}function k(){n.aspect=window.innerWidth/window.innerHeight,n.updateProjectionMatrix(),r.setSize(t.value.offsetWidth,t.value.offsetHeight)}return(0,i.bv)((()=>{E(),S()})),(0,i.Jd)((()=>{o.clear(),r.setAnimationLoop(null),r.dispose(),r.forceContextLoss(),r.content=null;let e=r.domElement.getContext("webgl");e&&e.getExtension("WEBGL_lose_context").loseContext()})),(e,n)=>((0,i.wg)(),(0,i.iD)("div",{class:"home-container",ref_key:"container",ref:t},null,512))}});const m=(0,a.Z)(g,[["__scopeId","data-v-3491bd88"]]);var x=m;const b=[{path:"/",name:"home",component:x}],y=(0,l.p7)({history:(0,l.PO)("/"),routes:b});var O=y,j=n(65),E=(0,j.MT)({state:{},getters:{},mutations:{},actions:{},modules:{}});(0,o.ri)(c).use(E).use(O).mount("#app")}},t={};function n(o){var i=t[o];if(void 0!==i)return i.exports;var r=t[o]={exports:{}};return e[o](r,r.exports,n),r.exports}n.m=e,function(){var e=[];n.O=function(t,o,i,r){if(!o){var a=1/0;for(l=0;l<e.length;l++){o=e[l][0],i=e[l][1],r=e[l][2];for(var s=!0,d=0;d<o.length;d++)(!1&r||a>=r)&&Object.keys(n.O).every((function(e){return n.O[e](o[d])}))?o.splice(d--,1):(s=!1,r<a&&(a=r));if(s){e.splice(l--,1);var c=i();void 0!==c&&(t=c)}}return t}r=r||0;for(var l=e.length;l>0&&e[l-1][2]>r;l--)e[l]=e[l-1];e[l]=[o,i,r]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={143:0};n.O.j=function(t){return 0===e[t]};var t=function(t,o){var i,r,a=o[0],s=o[1],d=o[2],c=0;if(a.some((function(t){return 0!==e[t]}))){for(i in s)n.o(s,i)&&(n.m[i]=s[i]);if(d)var l=d(n)}for(t&&t(o);c<a.length;c++)r=a[c],n.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return n.O(l)},o=self["webpackChunkvr_vue3"]=self["webpackChunkvr_vue3"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=n.O(void 0,[998],(function(){return n(4738)}));o=n.O(o)})();
//# sourceMappingURL=app.9d504a1a.js.map